<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QMS Admin Console</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <main class="page">
    <header class="header">
      <div>
        <p class="eyebrow">QMS Admin</p>
        <h1>Operations Console</h1>
        <p class="subtitle">Configure branches, services, devices, policies, and approvals.</p>
      </div>
      <div class="status" id="status">Idle</div>
    </header>

    <section class="card">
      <h2>Session Context</h2>
      <div class="grid">
        <label>
          Admin Base URL
          <input id="adminBase" value="http://localhost:8083" />
        </label>
        <label>
          Tenant ID
          <input id="tenantId" placeholder="UUID" />
        </label>
        <label>
          Role (X-Role)
          <select id="role">
            <option value="admin">admin</option>
            <option value="supervisor">supervisor</option>
            <option value="agent">agent</option>
          </select>
        </label>
        <label>
          User ID (X-User-ID)
          <input id="userId" placeholder="UUID" />
        </label>
        <button id="refreshAll">Refresh All</button>
      </div>
      <p class="hint" id="sessionHint"></p>
    </section>

    <section class="card split">
      <div>
        <h2>Branches</h2>
        <div class="grid">
          <label>
            New Branch Name
            <input id="branchName" placeholder="Jakarta HQ" />
          </label>
          <button id="createBranch">Create Branch</button>
        </div>
        <div class="list" id="branchList"></div>
        <h3 class="subhead">Areas</h3>
        <div class="grid">
          <label>
            Branch ID
            <input id="areaBranchId" placeholder="UUID" />
          </label>
          <label>
            Area Name
            <input id="areaName" placeholder="Lobby" />
          </label>
          <button id="createArea">Create Area</button>
          <button id="loadAreas" class="ghost">Load Areas</button>
        </div>
        <div class="list" id="areaList"></div>
      </div>
      <div>
        <h2>Services</h2>
        <div class="grid">
          <label>
            Branch ID
            <input id="serviceBranchId" placeholder="UUID" />
          </label>
          <label>
            Service Name
            <input id="serviceName" placeholder="Customer Service" />
          </label>
          <label>
            Code
            <input id="serviceCode" placeholder="CS" />
          </label>
          <label>
            SLA Minutes
            <input id="serviceSla" type="number" min="1" value="5" />
          </label>
          <label>
            Priority Policy
            <select id="servicePriority">
              <option value="fifo">fifo</option>
              <option value="priority">priority</option>
              <option value="mixed">mixed</option>
            </select>
          </label>
          <label class="full">
            Hours JSON (optional)
            <textarea id="serviceHours" rows="4" placeholder='{"mon":["08:00-16:00"],"sat":[]}'></textarea>
          </label>
          <button id="createService">Create Service</button>
        </div>
        <div class="list" id="serviceList"></div>
      </div>
    </section>

    <section class="card split">
      <div>
        <h2>Counters</h2>
        <div class="grid">
          <label>
            Branch ID
            <input id="counterBranchId" placeholder="UUID" />
          </label>
          <label>
            Counter Name
            <input id="counterName" placeholder="Counter 1" />
          </label>
          <button id="createCounter">Create Counter</button>
        </div>
        <div class="grid">
          <label>
            Counter ID
            <input id="mapCounterId" placeholder="UUID" />
          </label>
          <label>
            Service ID
            <input id="mapServiceId" placeholder="UUID" />
          </label>
          <button id="mapCounter">Map Service</button>
        </div>
        <div class="grid">
          <label>
            Counter ID
            <input id="skillsCounterId" placeholder="UUID" />
          </label>
          <button id="loadCounterSkills" class="ghost">Load Skills</button>
        </div>
        <div class="list" id="counterSkillsList"></div>
        <div class="list" id="counterList"></div>
      </div>
      <div>
        <h2>Policies</h2>
        <div class="grid">
          <label>
            Branch ID
            <input id="policyBranchId" placeholder="UUID" />
          </label>
          <label>
            Service ID
            <input id="policyServiceId" placeholder="UUID" />
          </label>
          <label>
            No-Show Grace (sec)
            <input id="policyGrace" type="number" min="60" value="300" />
          </label>
          <label>
            Return to Queue
            <select id="policyReturn">
              <option value="true">true</option>
              <option value="false">false</option>
            </select>
          </label>
          <label>
            Appointment Ratio (%)
            <input id="policyApptRatio" type="number" min="0" max="100" value="0" />
          </label>
          <label>
            Appointment Window
            <input id="policyApptWindow" type="number" min="1" value="10" />
          </label>
          <label>
            Appointment Boost (min)
            <input id="policyApptBoost" type="number" min="0" value="0" />
          </label>
          <button id="savePolicy">Save Policy</button>
        </div>
        <div class="list" id="policyView"></div>
        <p class="hint">Appointment ratio controls how many appointment tickets are preferred per window (e.g. 60% of 10 calls).</p>
        <p class="hint">Boost minutes prioritizes appointments whose scheduled time is within the window before they would normally be called.</p>
        <p class="hint" id="policyHint"></p>
      </div>
    </section>

    <section class="card split">
      <div>
        <h2>Devices</h2>
        <div class="grid">
          <label>
            Branch ID
            <input id="deviceBranchId" placeholder="UUID" />
          </label>
          <label>
            Device Type
            <select id="deviceType">
              <option value="kiosk">kiosk</option>
              <option value="display">display</option>
            </select>
          </label>
          <label>
            Area ID (optional)
            <input id="deviceAreaId" placeholder="UUID" />
          </label>
          <button id="registerDevice">Register Device</button>
        </div>
        <div class="list" id="deviceList"></div>
      </div>
      <div>
        <h2>Holidays</h2>
        <div class="grid">
          <label>
            Branch ID
            <input id="holidayBranchId" placeholder="UUID" />
          </label>
          <label>
            Date
            <input id="holidayDate" type="date" />
          </label>
          <label>
            Name
            <input id="holidayName" placeholder="Idul Fitri" />
          </label>
          <button id="createHoliday">Add Holiday</button>
        </div>
        <div class="list" id="holidayList"></div>
      </div>
    </section>

    <section class="card split">
      <div>
        <h2>Device Config</h2>
        <div class="grid">
          <label>
            Device ID
            <input id="configDeviceId" placeholder="UUID" />
          </label>
          <label>
            Version
            <input id="configVersion" type="number" min="1" value="1" />
          </label>
          <label class="full">
            Config JSON
            <textarea id="configPayload" rows="6" placeholder='{"theme":"branch-a","audio":true}'></textarea>
          </label>
          <button id="pushConfig">Push Config</button>
        </div>
        <div class="grid">
          <label>
            Device ID
            <input id="statusDeviceId" placeholder="UUID" />
          </label>
          <label>
            Status
            <select id="statusValue">
              <option value="online">online</option>
              <option value="offline">offline</option>
              <option value="maintenance">maintenance</option>
            </select>
          </label>
          <button id="updateStatus">Update Status</button>
        </div>
        <h3 class="subhead">Config History</h3>
        <div class="grid">
          <label>
            Device ID
            <input id="historyDeviceId" placeholder="UUID" />
          </label>
          <label>
            Limit
            <input id="historyLimit" type="number" min="1" value="10" />
          </label>
          <button id="loadHistory">Load History</button>
        </div>
        <div class="list" id="historyList"></div>
      </div>
      <div>
        <h2>Roles & Users</h2>
        <div class="grid">
          <label>
            Role Name
            <input id="roleName" placeholder="Supervisor" />
          </label>
          <button id="createRole">Create Role</button>
        </div>
        <div class="grid">
          <label>
            Target User ID
            <input id="targetUserId" placeholder="UUID" />
          </label>
          <label>
            Role ID
            <select id="roleAssign"></select>
          </label>
          <button id="assignRole">Assign Role</button>
        </div>
        <div class="list" id="roleList"></div>
        <div class="grid">
          <label>
            Edit Role Name
            <input id="roleEditName" placeholder="New role name" />
          </label>
          <label>
            Role ID
            <input id="roleEditId" placeholder="UUID" />
          </label>
          <button id="updateRole">Update Role</button>
          <button id="deleteRole" class="danger">Delete Role</button>
        </div>
        <div class="grid">
          <button id="loadUser">Load User Detail</button>
          <button id="clearUser" class="ghost">Clear</button>
        </div>
        <pre class="mono" id="userDetail">No user loaded.</pre>
        <div class="grid">
          <label>
            Search
            <input id="userQuery" placeholder="email or user id" />
          </label>
          <label>
            Limit
            <input id="userLimit" type="number" min="5" value="25" />
          </label>
          <label>
            Page
            <input id="userPage" type="number" min="1" value="1" />
          </label>
          <button id="searchUsers">Search Users</button>
        </div>
        <div class="grid">
          <button id="prevPage" class="ghost">Prev</button>
          <button id="nextPage" class="ghost">Next</button>
        </div>
        <div class="list" id="userList"></div>
        <div class="grid">
          <label>
            Create User Email
            <input id="userEmail" placeholder="user@example.com" />
          </label>
          <label>
            Role ID
            <select id="userRoleSelect"></select>
          </label>
          <label>
            Temp Password (optional)
            <input id="userPassword" placeholder="auto if empty" />
          </label>
          <button id="createUser">Create User</button>
        </div>
        <div class="grid">
          <label>
            Active
            <select id="userActive">
              <option value="true">true</option>
              <option value="false">false</option>
            </select>
          </label>
          <label>
            New Password (optional)
            <input id="resetPasswordValue" placeholder="auto if empty" />
          </label>
          <button id="saveUserStatus">Save Status</button>
          <button id="resetPassword" class="danger">Reset Password</button>
        </div>
        <h3 class="subhead">Access Scope</h3>
        <div class="grid">
          <button id="loadAccess">Load Access</button>
        </div>
        <div class="grid">
          <label>
            Branch ID
            <input id="accessBranchId" placeholder="UUID" />
          </label>
          <button id="addBranchAccess">Add Branch</button>
          <button id="removeBranchAccess" class="danger">Remove Branch</button>
        </div>
        <div class="grid">
          <label>
            Service ID
            <input id="accessServiceId" placeholder="UUID" />
          </label>
          <button id="addServiceAccess">Add Service</button>
          <button id="removeServiceAccess" class="danger">Remove Service</button>
        </div>
        <div class="list" id="accessBranches"></div>
        <div class="list" id="accessServices"></div>
      </div>
    </section>

    <section class="card split">
      <div>
        <h2>Approvals</h2>
        <div class="grid">
          <label>
            Status
            <select id="approvalStatus">
              <option value="">all</option>
              <option value="pending">pending</option>
              <option value="approved">approved</option>
            </select>
          </label>
          <button id="refreshApprovals">Refresh</button>
        </div>
        <div class="list" id="approvalList"></div>
      </div>
      <div>
        <h2>Approval Detail</h2>
        <pre class="mono" id="approvalDetail">Select an approval to see payload.</pre>
        <div class="grid">
          <label>
            Approvals Enabled
            <select id="approvalPref">
              <option value="false">false</option>
              <option value="true">true</option>
            </select>
          </label>
          <button id="saveApprovalPref">Save Preference</button>
        </div>
        <p class="hint" id="approvalPrefHint"></p>
      </div>
    </section>

    <section class="card split">
      <div>
        <h2>Audit Log</h2>
        <div class="grid">
          <label>
            Action Type
            <input id="auditAction" placeholder="branch.create" />
          </label>
          <label>
            User ID
            <input id="auditUser" placeholder="UUID" />
          </label>
          <button id="refreshAudit">Refresh</button>
          <button id="filterApprovalAudit" class="ghost">Approval Prefs Only</button>
        </div>
        <div class="list" id="auditList"></div>
      </div>
      <div>
        <h2>Notes</h2>
        <p class="hint">Config changes may require approval depending on tenant settings.</p>
        <p class="hint">Use X-Role header to simulate RBAC: admin or supervisor.</p>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
